<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Skywalkers SSC CGL 2026 Test Series</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <header class="site-header">
    <div class="logo">Skywalkers</div>
    <nav class="nav-links">
      <a href="#dashboard">Dashboard</a>
      <a href="#tests">Tests</a>
      <a href="#results">Results</a>
    </nav>
    <div class="auth-status" id="authStatus">Not signed in</div>
  </header>

  <main>
    <section class="hero">
      <div>
        <span class="pill">SSC CGL 2026 • Tier-1 • FREE</span>
        <h1>SSC CGL 2026 Test Series</h1>
        <p>Attempt 50 full-length Tier-1 tests with a custom timer, instant scoring, and best-score tracking.</p>
        <div class="hero-actions">
          <a class="primary" href="#tests">Start Practicing</a>
          <a class="secondary" href="#auth">Sign In</a>
        </div>
      </div>
      <div class="hero-card">
        <h3>Marking Scheme</h3>
        <ul>
          <li>Correct: <strong>+2</strong></li>
          <li>Wrong: <strong>-0.50</strong></li>
          <li>Unattempted: <strong>0</strong></li>
        </ul>
        <p>Unlimited attempts. Only your best score is stored for each test.</p>
      </div>
    </section>

    <section id="auth" class="card">
      <h2>Sign in to save your best scores</h2>
      <div class="auth-grid">
        <form id="registerForm">
          <h3>Create Account</h3>
          <label>Email
            <input type="email" id="registerEmail" required />
          </label>
          <label>Password
            <input type="password" id="registerPassword" minlength="6" required />
          </label>
          <button type="submit">Create Account</button>
        </form>
        <form id="loginForm">
          <h3>Sign In</h3>
          <label>Email
            <input type="email" id="loginEmail" required />
          </label>
          <label>Password
            <input type="password" id="loginPassword" required />
          </label>
          <button type="submit">Sign In</button>
        </form>
      </div>
      <button class="ghost" id="signOutBtn" type="button">Sign Out</button>
      <p class="auth-note" id="authMessage"></p>
    </section>

    <section id="dashboard" class="card">
      <div class="section-header">
        <h2>Dashboard</h2>
        <p>Track your Tier-1 practice at a glance.</p>
      </div>
      <div class="dashboard-grid">
        <div class="metric">
          <span>Total Tests</span>
          <strong id="totalTests">50</strong>
        </div>
        <div class="metric">
          <span>Attempted Tests</span>
          <strong id="attemptedTests">0</strong>
        </div>
        <div class="metric">
          <span>Best Score</span>
          <strong id="bestScore">0</strong>
        </div>
        <div class="metric">
          <span>Accuracy %</span>
          <strong id="accuracy">0%</strong>
        </div>
      </div>
    </section>

    <section id="tests" class="card">
      <div class="section-header">
        <h2>Full Test Series</h2>
        <p>Choose any test. Select a timer before you start.</p>
      </div>
      <div class="test-grid" id="testGrid"></div>
    </section>

    <section id="testRunner" class="card hidden">
      <div class="test-header">
        <div>
          <h2 id="activeTestTitle">Test</h2>
          <p id="activeTestMeta">Choose a timer and start your attempt.</p>
        </div>
        <div class="timer-box">
          <span>Time Left</span>
          <strong id="timerDisplay">00:00</strong>
        </div>
      </div>
      <div class="timer-select">
        <label><input type="radio" name="timer" value="60" /> 60 Minutes</label>
        <label><input type="radio" name="timer" value="75" /> 75 Minutes</label>
        <label><input type="radio" name="timer" value="90" /> 90 Minutes</label>
        <button id="startTestBtn" type="button">Start Test</button>
      </div>
      <form id="questionForm" class="question-list"></form>
      <div class="test-actions">
        <button id="submitTestBtn" type="button">Submit Test</button>
        <button id="resetTestBtn" type="button" class="ghost">Reset Answers</button>
      </div>
    </section>

    <section id="results" class="card">
      <div class="section-header">
        <h2>Result Summary</h2>
        <p>Your latest attempt details appear here.</p>
      </div>
      <div class="result-grid">
        <div>
          <h3 id="resultScore">Score: 0</h3>
          <p id="resultMeta">Correct: 0 • Wrong: 0 • Unattempted: 0</p>
          <p id="resultAccuracy">Accuracy: 0%</p>
          <p id="resultTime">Time Taken: 0m</p>
        </div>
        <div class="result-actions">
          <button class="primary" id="reAttemptBtn" type="button">Re-attempt</button>
        </div>
      </div>
      <div id="resultDetails" class="result-details"></div>
    </section>
  </main>

  <footer class="site-footer">
    <p>Skywalkers • SSC CGL 2026 Tier-1 Test Series • Built for focused preparation.</p>
  </footer>

  <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCgiM5aNDDJhFHGG9-eK-lwAEPM3u4w448",
  authDomain: "sign-in-ae5ca.firebaseapp.com",
  projectId: "sign-in-ae5ca",
  storageBucket: "sign-in-ae5ca.firebasestorage.app",
  messagingSenderId: "976958705327",
  appId: "1:976958705327:web:d99ebeeb72154797d34e5a",
  measurementId: "G-66LVVCPBZ7"
};

const app = initializeApp(firebaseConfig);
getAnalytics(app);
const auth = getAuth(app);

const authMessage = document.getElementById("authMessage");
const authStatus = document.getElementById("authStatus");
const signOutBtn = document.getElementById("signOutBtn");

const registerForm = document.getElementById("registerForm");
const loginForm = document.getElementById("loginForm");

const state = {
  user: null,
  activeTest: null,
  questions: [],
  timer: null,
  durationMinutes: 0,
  remainingSeconds: 0,
  lastResult: null
};

const testGrid = document.getElementById("testGrid");
const testRunner = document.getElementById("testRunner");
const questionForm = document.getElementById("questionForm");
const activeTestTitle = document.getElementById("activeTestTitle");
const activeTestMeta = document.getElementById("activeTestMeta");
const timerDisplay = document.getElementById("timerDisplay");
const startTestBtn = document.getElementById("startTestBtn");
const submitTestBtn = document.getElementById("submitTestBtn");
const resetTestBtn = document.getElementById("resetTestBtn");
const reAttemptBtn = document.getElementById("reAttemptBtn");

const totalTestsEl = document.getElementById("totalTests");
const attemptedTestsEl = document.getElementById("attemptedTests");
const bestScoreEl = document.getElementById("bestScore");
const accuracyEl = document.getElementById("accuracy");

const resultScore = document.getElementById("resultScore");
const resultMeta = document.getElementById("resultMeta");
const resultAccuracy = document.getElementById("resultAccuracy");
const resultTime = document.getElementById("resultTime");
const resultDetails = document.getElementById("resultDetails");

const TEST_COUNT = 50;

const formatTime = (seconds) => {
  const mins = Math.floor(seconds / 60);
  const secs = seconds % 60;
  return `${String(mins).padStart(2, "0")}:${String(secs).padStart(2, "0")}`;
};

const showMessage = (message, type = "info") => {
  authMessage.textContent = message;
  authMessage.dataset.type = type;
};

const getStorageKey = (testId) => {
  if (!state.user) return null;
  return `skywalkers_${state.user.uid}_test_${testId}`;
};

const saveBestScore = (testId, result) => {
  const key = getStorageKey(testId);
  if (!key) return;
  const existing = JSON.parse(localStorage.getItem(key));
  if (!existing || result.score > existing.score) {
    localStorage.setItem(key, JSON.stringify(result));
  }
};

const loadBestScore = (testId) => {
  const key = getStorageKey(testId);
  if (!key) return null;
  return JSON.parse(localStorage.getItem(key));
};

const updateDashboard = () => {
  totalTestsEl.textContent = TEST_COUNT;
  if (!state.user) {
    attemptedTestsEl.textContent = "0";
    bestScoreEl.textContent = "0";
    accuracyEl.textContent = "0%";
    return;
  }

  let attempted = 0;
  let bestScore = 0;
  let accuracySum = 0;
  for (let i = 1; i <= TEST_COUNT; i += 1) {
    const stored = loadBestScore(i);
    if (stored) {
      attempted += 1;
      bestScore = Math.max(bestScore, stored.score);
      accuracySum += stored.accuracy;
    }
  }
  attemptedTestsEl.textContent = attempted;
  bestScoreEl.textContent = bestScore.toFixed(1);
  const avgAccuracy = attempted ? accuracySum / attempted : 0;
  accuracyEl.textContent = `${avgAccuracy.toFixed(1)}%`;
};

const renderTests = () => {
  testGrid.innerHTML = "";
  for (let i = 1; i <= TEST_COUNT; i += 1) {
    const card = document.createElement("div");
    card.className = "test-card";

    const best = loadBestScore(i);
    const buttonLabel = best ? "Re-attempt" : "Start";

    card.innerHTML = `
      <div>
        <h3>Test ${i}</h3>
        <p>Tier-1 • Full Length</p>
        <span class="badge">${best ? `Best: ${best.score.toFixed(1)}` : "Not Attempted"}</span>
      </div>
      <button data-test="${i}">${buttonLabel}</button>
    `;

    card.querySelector("button").addEventListener("click", () => {
      if (!state.user) {
        showMessage("Please sign in to start a test.", "warning");
        document.getElementById("auth").scrollIntoView({ behavior: "smooth" });
        return;
      }
      loadTest(i);
    });

    testGrid.appendChild(card);
  }
};

const clearTimer = () => {
  if (state.timer) {
    clearInterval(state.timer);
    state.timer = null;
  }
};

const resetTestUI = () => {
  clearTimer();
  timerDisplay.textContent = "00:00";
  questionForm.innerHTML = "";
  state.questions = [];
  state.remainingSeconds = 0;
  state.durationMinutes = 0;
  [...document.querySelectorAll("input[name='timer']")].forEach((input) => {
    input.checked = false;
  });
};

const loadTest = async (testId) => {
  resetTestUI();
  state.activeTest = testId;
  activeTestTitle.textContent = `Test ${testId}`;
  activeTestMeta.textContent = "Select a timer and press start.";
  testRunner.classList.remove("hidden");
  testRunner.scrollIntoView({ behavior: "smooth" });
  try {
    const response = await fetch(`data/test-${testId}.json`);
    state.questions = await response.json();
    renderQuestions();
  } catch (error) {
    questionForm.innerHTML = "<p>Unable to load questions. Please try again.</p>";
  }
};

const renderQuestions = () => {
  questionForm.innerHTML = "";
  state.questions.forEach((item, index) => {
    const wrapper = document.createElement("div");
    wrapper.className = "question-card";
    const options = item.options
      .map((option, optionIndex) => {
        return `
          <label>
            <input type="radio" name="q${index}" value="${optionIndex}" />
            <span>${option}</span>
          </label>
        `;
      })
      .join("");

    wrapper.innerHTML = `
      <h4>Q${index + 1}. ${item.question}</h4>
      <div class="option-list">${options}</div>
    `;
    questionForm.appendChild(wrapper);
  });
};

const startTimer = () => {
  clearTimer();
  state.remainingSeconds = state.durationMinutes * 60;
  timerDisplay.textContent = formatTime(state.remainingSeconds);
  state.timer = setInterval(() => {
    state.remainingSeconds -= 1;
    timerDisplay.textContent = formatTime(state.remainingSeconds);
    if (state.remainingSeconds <= 0) {
      clearTimer();
      submitTest();
    }
  }, 1000);
};

const getSelectedDuration = () => {
  const selected = document.querySelector("input[name='timer']:checked");
  if (!selected) return 0;
  return Number(selected.value);
};

const collectAnswers = () => {
  return state.questions.map((_, index) => {
    const choice = document.querySelector(`input[name='q${index}']:checked`);
    return choice ? Number(choice.value) : null;
  });
};

const submitTest = () => {
  if (!state.activeTest) return;
  const answers = collectAnswers();
  let correct = 0;
  let wrong = 0;
  let unattempted = 0;

  answers.forEach((answer, index) => {
    if (answer === null) {
      unattempted += 1;
      return;
    }
    if (answer === state.questions[index].correct) {
      correct += 1;
    } else {
      wrong += 1;
    }
  });

  const score = correct * 2 - wrong * 0.5;
  const accuracy = state.questions.length ? (correct / state.questions.length) * 100 : 0;
  const timeTaken = state.durationMinutes * 60 - state.remainingSeconds;

  const result = {
    score,
    correct,
    wrong,
    unattempted,
    accuracy,
    timeTaken,
    total: state.questions.length,
    testId: state.activeTest
  };

  state.lastResult = result;
  saveBestScore(state.activeTest, result);
  updateDashboard();
  renderTests();
  renderResult(result);
  clearTimer();
};

const renderResult = (result) => {
  resultScore.textContent = `Score: ${result.score.toFixed(1)}`;
  resultMeta.textContent = `Correct: ${result.correct} • Wrong: ${result.wrong} • Unattempted: ${result.unattempted}`;
  resultAccuracy.textContent = `Accuracy: ${result.accuracy.toFixed(1)}%`;
  resultTime.textContent = `Time Taken: ${Math.ceil(result.timeTaken / 60)}m`;
  resultDetails.innerHTML = state.questions
    .map((item, index) => {
      const answer = collectAnswers()[index];
      const status = answer === null
        ? "Unattempted"
        : answer === item.correct
          ? "Correct"
          : "Wrong";
      return `
        <div class="result-card">
          <h4>Q${index + 1}. ${item.question}</h4>
          <p><strong>Status:</strong> ${status}</p>
          <p><strong>Correct:</strong> ${item.options[item.correct]}</p>
          <p class="explanation">${item.explanation}</p>
        </div>
      `;
    })
    .join("");

  document.getElementById("results").scrollIntoView({ behavior: "smooth" });
};

startTestBtn.addEventListener("click", () => {
  if (!state.activeTest) return;
  state.durationMinutes = getSelectedDuration();
  if (!state.durationMinutes) {
    showMessage("Select a timer duration before starting.", "warning");
    return;
  }
  showMessage("Timer started. Good luck!", "success");
  startTimer();
});

submitTestBtn.addEventListener("click", () => {
  if (!state.durationMinutes) {
    showMessage("Start the test before submitting.", "warning");
    return;
  }
  submitTest();
});

resetTestBtn.addEventListener("click", () => {
  questionForm.reset();
});

reAttemptBtn.addEventListener("click", () => {
  if (state.activeTest) {
    loadTest(state.activeTest);
  } else {
    document.getElementById("tests").scrollIntoView({ behavior: "smooth" });
  }
});

registerForm.addEventListener("submit", async (event) => {
  event.preventDefault();
  try {
    await createUserWithEmailAndPassword(
      auth,
      document.getElementById("registerEmail").value,
      document.getElementById("registerPassword").value
    );
    showMessage("Account created. You are signed in.", "success");
  } catch (error) {
    showMessage(error.message, "error");
  }
});

loginForm.addEventListener("submit", async (event) => {
  event.preventDefault();
  try {
    await signInWithEmailAndPassword(
      auth,
      document.getElementById("loginEmail").value,
      document.getElementById("loginPassword").value
    );
    showMessage("Welcome back!", "success");
  } catch (error) {
    showMessage(error.message, "error");
  }
});

signOutBtn.addEventListener("click", async () => {
  try {
    await signOut(auth);
    showMessage("Signed out.", "info");
  } catch (error) {
    showMessage(error.message, "error");
  }
});

onAuthStateChanged(auth, (user) => {
  state.user = user;
  authStatus.textContent = user ? `Signed in as ${user.email}` : "Not signed in";
  signOutBtn.style.display = user ? "inline-flex" : "none";
  updateDashboard();
  renderTests();
});

updateDashboard();
renderTests();
  </script>
</body>
</html>
